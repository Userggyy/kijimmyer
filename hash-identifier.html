<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hash-Identifier 新手教學 | 資安學習平台</title>
    <meta name="description" content="Hash-Identifier 雜湊辨識工具完整教學，從安裝到實戰辨識、策略與整合">
    <style>
        :root {
            --primary: #2a3b4d;
            --secondary: #3a6ea5;
            --accent: #ff7f50;
            --light: #ffffff;
            --dark: #1a2a3a;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #F44336;
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --bg-gradient: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: var(--bg-gradient); color: var(--text-primary); line-height: 1.6; min-height: 100vh; }
        .skip-link { position: absolute; top: -40px; left: 0; background: var(--secondary); color: white; padding: 8px; z-index: 100; transition: top 0.3s; }
        .skip-link:focus { top: 0; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        header { background: linear-gradient(135deg, var(--primary), var(--secondary)); padding: 2rem 0; text-align: center; border-bottom: 4px solid var(--accent); margin-bottom: 2rem; border-radius: 0 0 10px 10px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); position: relative; }
        header h1 { font-size: 2.5rem; margin-bottom: 0.5rem; color: white; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); }
        header p { font-size: 1.1rem; color: rgba(255, 255, 255, 0.9); max-width: 800px; margin: 0 auto; }
        nav { background-color: var(--dark); padding: 1rem; border-radius: 8px; margin-bottom: 2rem; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); }
        nav ul { display: flex; justify-content: center; list-style: none; flex-wrap: wrap; }
        nav li { margin: 0 15px; }
        nav a { color: var(--light); text-decoration: none; font-weight: 500; padding: 5px 10px; border-radius: 4px; transition: all 0.3s ease; }
        nav a:hover, nav a:focus { background-color: var(--secondary); color: white; outline: none; }
        section { background: rgba(30, 30, 30, 0.8); backdrop-filter: blur(10px); border-radius: 8px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.25); border-left: 4px solid var(--secondary); border: 1px solid rgba(58, 110, 165, 0.3); }
        h2 { color: var(--accent); margin-bottom: 1.5rem; font-size: 1.8rem; border-bottom: 2px solid var(--secondary); padding-bottom: 0.5rem; display: inline-block; }
        h3 { color: var(--light); margin: 1.5rem 0 1rem; font-size: 1.4rem; }
        p { margin-bottom: 1rem; color: var(--text-secondary); }
        .terminal { background-color: #000000; color: #00ff00; padding: 1.5rem; border-radius: 8px; font-family: 'Courier New', Courier, monospace; margin: 1.5rem 0; position: relative; border: 1px solid #333; box-shadow: inset 0 0 10px rgba(0, 255, 0, 0.1); overflow-x: auto; }
        .terminal:before { content: "Terminal"; position: absolute; top: -10px; left: 15px; background-color: #000; color: #00ff00; padding: 0 10px; font-size: 0.8rem; border: 1px solid #333; border-bottom: none; border-radius: 5px 5px 0 0; }
        .command { color: #00ffff; font-weight: bold; cursor: pointer; transition: all 0.3s ease; position: relative; display: inline-block; padding: 2px 5px; border-radius: 3px; }
        .command:hover { text-shadow: 0 0 8px rgba(0, 255, 255, 0.7); }
        .command:after { content: ''; position: absolute; bottom: -2px; left: 0; width: 0; height: 2px; background: var(--accent); transition: width 0.3s; }
        .command:hover:after { width: 100%; }
        .option { color: #ffa500; }
        .comment { color: #888; font-style: italic; }
        .note { background-color: rgba(58, 110, 165, 0.2); border-left: 4px solid var(--secondary); padding: 1rem; margin: 1.5rem 0; border-radius: 0 4px 4px 0; }
        .warning { background-color: rgba(255, 193, 7, 0.2); border-left: 4px solid var(--warning); padding: 1rem; margin: 1.5rem 0; border-radius: 0 4px 4px 0; }
        .danger { background-color: rgba(244, 67, 54, 0.2); border-left: 4px solid var(--danger); padding: 1rem; margin: 1.5rem 0; border-radius: 0 4px 4px 0; }
        .example { background-color: rgba(42, 59, 77, 0.3); padding: 1.5rem; border-radius: 8px; margin: 1.5rem 0; border: 1px dashed var(--secondary); }
        .example h4 { color: var(--accent); margin-bottom: 1rem; }
        .quiz { background-color: rgba(42, 59, 77, 0.5); padding: 1.5rem; border-radius: 8px; margin: 1.5rem 0; border: 1px solid var(--secondary); }
        .quiz h4 { color: var(--accent); margin-bottom: 1rem; }
        .quiz-option { display: block; margin: 0.5rem 0; padding: 0.5rem; background-color: rgba(255, 255, 255, 0.1); border-radius: 4px; cursor: pointer; transition: all 0.2s; }
        .quiz-option:hover, .quiz-option:focus { background-color: rgba(255, 255, 255, 0.2); outline: 2px solid var(--accent); }
        .btn { display: inline-block; background-color: var(--secondary); color: white; padding: 0.5rem 1rem; border-radius: 4px; text-decoration: none; font-weight: bold; transition: all 0.3s; border: none; cursor: pointer; margin-top: 0.5rem; }
        .btn:hover, .btn:focus { background-color: var(--accent); transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); outline: none; }
        .btn:active { transform: translateY(0); }
        footer { text-align: center; padding: 2rem 0; margin-top: 2rem; color: #888; font-size: 0.9rem; border-top: 1px solid #333; }
        .progress-tracker { background: rgba(30, 30, 30, 0.8); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; border-left: 4px solid var(--accent); }
        .progress-tracker h3 { margin-top: 0; color: var(--accent); }
        .progress-bar { height: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 5px; margin: 1rem 0; overflow: hidden; }
        .progress { height: 100%; background: linear-gradient(90deg, var(--secondary), var(--accent)); width: 20%; transition: width 0.5s ease; }
        .progress-steps { display: flex; justify-content: space-between; list-style: none; padding: 0; }
        .progress-steps li { text-align: center; position: relative; flex: 1; padding-top: 25px; color: #888; }
        .progress-steps li:before { content: ''; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 20px; height: 20px; border-radius: 50%; background: #333; border: 3px solid #333; }
        .progress-steps li.completed:before { background: var(--success); border-color: var(--success); }
        .progress-steps li.active:before { background: var(--accent); border-color: var(--accent); box-shadow: 0 0 0 3px rgba(255, 127, 80, 0.3); }
        .virtual-lab { background: rgba(30, 30, 30, 0.9); padding: 2rem; border-radius: 8px; margin-bottom: 2rem; border: 1px solid var(--secondary); }
        .lab-instructions { margin-bottom: 1.5rem; }
        .lab-instructions ol { margin-left: 1.5rem; }
        .btn-copy { background: rgba(58, 110, 165, 0.3); color: var(--light); border: 1px solid var(--secondary); border-radius: 4px; padding: 0.2rem 0.5rem; margin-left: 0.5rem; font-size: 0.8rem; cursor: pointer; transition: all 0.2s; }
        .btn-copy:hover { background: rgba(58, 110, 165, 0.5); }
        .security-warning { background-color: rgba(255, 0, 0, 0.1); border: 1px solid var(--danger); padding: 1rem; border-radius: 8px; margin: 1rem 0; animation: pulse 2s infinite; }
        .advanced-section { background: rgba(42, 59, 77, 0.5); border-left: 4px solid var(--accent); padding: 1.5rem; margin: 2rem 0; }
        .tab-container { display: flex; margin-bottom: -1px; }
        .tab { padding: 0.8rem 1.5rem; background: rgba(30, 30, 30, 0.7); border: 1px solid #444; border-bottom: none; border-radius: 5px 5px 0 0; cursor: pointer; margin-right: 5px; }
        .tab.active { background: rgba(30, 30, 30, 0.9); border-color: var(--secondary); color: var(--accent); }
        .tab-content { display: none; padding: 1.5rem; background: rgba(30, 30, 30, 0.9); border: 1px solid var(--secondary); border-radius: 0 8px 8px 8px; }
        .tab-content.active { display: block; }
        .save-progress { background-color: var(--success); color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; margin-top: 1rem; transition: all 0.3s; }
        .save-progress:hover { background-color: #3d8b40; }
        .explanation { background-color: rgba(58, 110, 165, 0.2); padding: 1rem; border-radius: 8px; margin: 1rem 0; display: none; }
        .tag { display: inline-block; padding: 0.2rem 0.5rem; border-radius: 3px; font-size: 0.8rem; font-weight: bold; margin-left: 0.5rem; }
        .tag-advanced { background-color: rgba(255, 127, 80, 0.2); color: var(--accent); border: 1px solid var(--accent); }
        .tag-warning { background-color: rgba(255, 193, 7, 0.2); color: var(--warning); border: 1px solid var(--warning); }
        .case-study { background-color: rgba(42, 59, 77, 0.3); padding: 1.5rem; border-radius: 8px; margin: 1.5rem 0; border-left: 4px solid var(--accent); }
        @media (max-width: 768px) {
            nav ul { flex-direction: column; align-items: center; }
            nav li { margin: 5px 0; }
            header h1 { font-size: 2rem; }
            section, .virtual-lab, .progress-tracker { padding: 1.5rem; }
            .progress-steps { flex-wrap: wrap; }
            .progress-steps li { flex: 0 0 50%; margin-bottom: 1rem; }
            .tab-container { flex-wrap: wrap; }
            .tab { margin-bottom: 5px; border-radius: 5px; border: 1px solid #444; }
            .tab-content { border-radius: 0 0 8px 8px; }
        }
        @media (max-width: 576px) { .terminal { font-size: 0.9rem; padding: 1rem; } .command { white-space: pre-wrap; word-break: break-all; } }
        :focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 127, 80, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(255, 127, 80, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 127, 80, 0); } }
        .pulse { animation: pulse 2s infinite; }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">跳至主要內容</a>
    <div class="container">
        <header>
            <h1>Hash-Identifier 新手教學</h1>
            <p>學習如何快速辨識雜湊(Hash)類型，並了解雜湊家族特徵、破解策略與合法使用注意事項</p>
        </header>
        <nav aria-label="主要導航">
            <ul role="menubar">
                <li role="menuitem"><a href="#introduction">基本介紹</a></li>
                <li role="menuitem"><a href="#commands">基本指令</a></li>
                <li role="menuitem"><a href="#examples">實戰範例</a></li>
                <li role="menuitem"><a href="#advanced">進階技巧</a></li>
                <li role="menuitem"><a href="#defense">安全與限制</a></li>
                <li role="menuitem"><a href="#legal">法律規範</a></li>
            </ul>
        </nav>
        <div class="progress-tracker">
            <h3>您的學習進度</h3>
            <div class="progress-bar">
                <div class="progress" id="learning-progress" style="width: 20%"></div>
            </div>
            <ul class="progress-steps">
                <li class="completed">基本介紹</li>
                <li class="active">基本指令</li>
                <li>實戰範例</li>
                <li>進階技巧</li>
                <li>安全與限制</li>
                <li>法律規範</li>
            </ul>
            <button class="save-progress">保存進度</button>
        </div>
        <main id="main-content">
            <section id="introduction">
                <h2>Hash-Identifier 基本介紹</h2>
                <p>Hash-Identifier 是用於 <strong>辨識雜湊字串所屬演算法</strong> 的工具。透過分析字元集、長度、前綴等特徵，它能推測可能的雜湊類型，協助後續的破解或驗證流程。</p>
                <div class="note">
                    <p>Hash-Identifier 常見於 Kali Linux。辨識結果通常是 <em>可能清單</em>，請搭配其他工具 (如 <code>hashcat</code> / <code>john</code>) 進一步驗證。</p>
                </div>
                <h3>安裝方法</h3>
                <p>在 Kali/Ubuntu 可以使用下列指令安裝或確認存在：</p>
                <div class="terminal">
                    <span class="command" tabindex="0" aria-label="更新套件列表，點擊複製命令">sudo apt update</span><br>
                    <span class="command" tabindex="0" aria-label="安裝 hash-identifier，點擊複製命令">sudo apt install hash-identifier</span><br>
                    <span class="command" tabindex="0" aria-label="執行 hash-identifier，點擊複製命令">hash-identifier</span>
                </div>
                <p>第一次啟動後，會顯示互動式提示，直接貼上雜湊即可辨識。</p>
            </section>
            <section id="commands">
                <h2>基本指令教學</h2>
                <p>Hash-Identifier 多為互動式使用；也可直接將雜湊管線傳入。以下為常用方式：</p>
                <h3>互動模式</h3>
                <div class="terminal">
                    <span class="comment"># 啟動互動介面，依提示貼上雜湊</span><br>
                    <span class="command" tabindex="0">hash-identifier</span>
                </div>
                <h3>管線方式</h3>
                <div class="terminal">
                    <span class="comment"># 將雜湊透過 echo 輸入 (範例為 MD5)</span><br>
                    <span class="command" tabindex="0">echo -n "5f4dcc3b5aa765d61d8327deb882cf99" | hash-identifier</span>
                </div>
                <h3>常見雜湊特徵</h3>
                <ul aria-label="雜湊長度與特徵">
                    <li><strong>MD5</strong>: 32 位十六進位</li>
                    <li><strong>SHA-1</strong>: 40 位十六進位</li>
                    <li><strong>SHA-256</strong>: 64 位十六進位</li>
                    <li><strong>SHA-512</strong>: 128 位十六進位</li>
                    <li><strong>bcrypt</strong>: 以 <code>$2a$/$2b$/$2y$</code> 開頭，含 cost 與 22 位 Base64 salt</li>
                    <li><strong>Argon2</strong>: 以 <code>$argon2id$</code>/<code>$argon2i$</code>/<code>$argon2d$</code> 開頭，含參數、salt、tag</li>
                    <li><strong>NTLM</strong>: 32 位十六進位 (常與 MD5 混淆，需要情境佐證)</li>
                </ul>
                <div class="quiz">
                    <h4>小測驗</h4>
                    <p>下列哪一個最像 <strong>SHA-256</strong>？</p>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">32 位十六進位</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, true)">64 位十六進位</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">128 位十六進位</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">$2y$ 開頭且內含 cost</div>
                    <p id="quiz-feedback" style="display:none; margin-top:10px; color:var(--accent);"></p>
                    <div class="explanation">
                        <p><strong>解析：</strong> SHA-256 的典型輸出長度為 64 位十六進位字元。</p>
                    </div>
                </div>
            </section>
            <section id="examples">
                <h2>實戰範例</h2>
                <div class="example">
                    <h4>範例1: 辨識常見 MD5</h4>
                    <div class="terminal">
                        <span class="command" tabindex="0">echo -n "5f4dcc3b5aa765d61d8327deb882cf99" | hash-identifier</span>
                    </div>
                    <p>輸入 <code>5f4d...</code>（"password" 的 MD5），工具會顯示可能類型：MD5/MD4/NTLM 等，實務上可再用 hashcat 的 <code>-m 0</code> 嘗試。</p>
                </div>
                <div class="example">
                    <h4>範例2: 辨識 bcrypt</h4>
                    <div class="terminal">
                        <span class="command" tabindex="0">echo "$2y$10$abcdefghijklmnopqrstuuS9mC0Z3J7Qf2Gv1yBq8m0C3Cw3x7w" | hash-identifier</span>
                    </div>
                    <p>以 <code>$2y$10$</code> 開頭表示 bcrypt，cost=10；破解可用 hashcat <code>-m 3200</code> 或 John 的 <code>bcrypt</code> 模組。</p>
                </div>
                <div class="case-study">
                    <h4>案例：小型站台憑證評估流程</h4>
                    <ol>
                        <li>從資料庫匯出雜湊樣本（合法授權）</li>
                        <li>使用 Hash-Identifier 產生可能清單</li>
                        <li>依清單挑選對應模組（hashcat 模式編號 / John 格式）</li>
                        <li>透過字典/規則/遮罩等策略驗證可行性</li>
                    </ol>
                </div>
                <div class="warning">
                    <p>注意：辨識雜湊不等於已破解。請務必於授權與合規前提下進行測試。</p>
                </div>
                <div class="quiz">
                    <h4>小測驗</h4>
                    <p>看到字串以 <code>$argon2id$</code> 開頭，你會優先判定為？</p>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, true)">Argon2id</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">SHA-512</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">bcrypt</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">MD5</div>
                    <p id="quiz-feedback2" style="display:none; margin-top:10px; color:var(--accent);"></p>
                    <div class="explanation">
                        <p><strong>解析：</strong> Argon2 家族以 <code>$argon2...$</code> 為前綴，包含參數（m/t/p）、salt 與 tag。</p>
                    </div>
                </div>
            </section>
            <section id="advanced">
                <h2>進階使用技巧</h2>
                <div class="security-warning">
                    <p>⚠️ 僅在合法授權情境下進行雜湊辨識與測試。請先完成書面同意與資料最小化。</p>
                </div>
                <div class="tab-container">
                    <div class="tab active" onclick="openTab(event, 'strategy')">辨識策略</div>
                    <div class="tab" onclick="openTab(event, 'families')">常見雜湊家族</div>
                    <div class="tab" onclick="openTab(event, 'export')">匯出與整合</div>
                </div>
                <div id="strategy" class="tab-content active">
                    <h3>提高準確率的策略</h3>
                    <div class="terminal">
                        <span class="comment"># 1) 先看長度與字元集</span><br>
                        <span class="comment"># 2) 檢查是否有前綴 (如 $2y$, $6$, $argon2id$)</span><br>
                        <span class="comment"># 3) 結合來源系統 (如 Windows 網域多見 NTLM)</span><br>
                        <span class="comment"># 4) 交叉驗證：以 hashcat/John 嘗試小字典</span>
                    </div>
                    <p>同長度雜湊可能對應多種算法（如 32 位：MD5/MD4/NTLM）。來源脈絡與樣本對照是關鍵。</p>
                    <div class="quiz">
                        <h4>小測驗</h4>
                        <p>若來自 Windows AD 的 32 位十六進位，最可能是？</p>
                        <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, true)">NTLM</div>
                        <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">MD5</div>
                        <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">SHA-1</div>
                        <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">bcrypt</div>
                        <p id="quiz-feedback4" style="display:none; margin-top:10px; color:var(--accent);"></p>
                        <div class="explanation"><p><strong>解析：</strong> 情境判斷很重要；AD/Windows 環境中 NTLM 常見。</p></div>
                    </div>
                </div>
                <div id="families" class="tab-content">
                    <h3>雜湊家族與樣式</h3>
                    <ul>
                        <li><strong>MDx</strong>：MD2/MD4/MD5，多為 32 位十六進位</li>
                        <li><strong>SHA 家族</strong>：SHA-1(40)、SHA-256(64)、SHA-512(128)</li>
                        <li><strong>bcrypt</strong>：<code>$2y$cost$salt$hash</code>，適配 hashcat <code>-m 3200</code></li>
                        <li><strong>PBKDF2</strong>：常見 <code>pbkdf2:sha256:it:salt:hash</code> 類格式</li>
                        <li><strong>Argon2</strong>：<code>$argon2id$</code>/<code>$argon2i$</code>/<code>$argon2d$</code></li>
                        <li><strong>Windows/Unix</strong>：NTLM / <code>$6$</code>(SHA-512 crypt) / <code>$5$</code>(SHA-256 crypt)</li>
                    </ul>
                </div>
                <div id="export" class="tab-content">
                    <h3>匯出與整合</h3>
                    <p>將辨識結果映射到破解工具：</p>
                    <div class="terminal">
                        <span class="comment"># MD5 與 hashcat</span><br>
                        <span class="command" tabindex="0">hashcat -m 0 -a 0 hash.txt rockyou.txt</span><br><br>
                        <span class="comment"># bcrypt 與 hashcat</span><br>
                        <span class="command" tabindex="0">hashcat -m 3200 -a 0 hash.txt wordlist.txt</span><br><br>
                        <span class="comment"># John 指定格式 (例: NT)</span><br>
                        <span class="command" tabindex="0">john --format=NT hashes.txt --wordlist=rockyou.txt</span>
                    </div>
                    <p>建議建立「雜湊樣本 → 可能算法 → 對應模式編號/格式」的速查表，便於批次處理。</p>
                </div>
            </section>
            <section id="defense">
                <h2>安全與限制</h2>
                <p>雜湊辨識的目的是確定演算法以便合規測試與修補：</p>
                <h3>1. 強化密碼儲存</h3>
                <p>使用具記憶體硬耗的 KDF（如 Argon2、scrypt），搭配獨立隨機 salt 與足夠迭代/成本。</p>
                <h3>2. 設計限速與監控</h3>
                <p>對暴力嘗試實施速率限制、MFA 與異常偵測，降低破解成功率。</p>
                <h3>3. 管理風險與曝光</h3>
                <p>避免在日誌或除錯輸出中留下雜湊；定期審核與輪替策略。</p>
                <div class="note"><p>辨識到 <strong>快速雜湊</strong>（如 MD5/SHA-1）代表高風險，應優先改為針對密碼設計的演算法（bcrypt/Argon2）。</p></div>
                <div class="quiz">
                    <h4>小測驗</h4>
                    <p>哪一項 <em>最不適合</em> 做為密碼儲存？</p>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, true)">純 SHA-1 無 salt</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">Argon2id（含充分參數）</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">bcrypt（合理 cost）</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">PBKDF2（足夠迭代）</div>
                    <p id="quiz-feedback5" style="display:none; margin-top:10px; color:var(--accent);"></p>
                    <div class="explanation"><p><strong>解析：</strong> 快速雜湊（如 SHA-1、MD5）不適合存放密碼，容易被 GPU/ASIC 暴力破解。</p></div>
                </div>
            </section>
            <section id="legal">
                <h2>法律與道德規範</h2>
                <div class="danger"><p>重要：未經授權取得或嘗試破解他人雜湊值，可能違反個資與電腦相關法律，後果嚴重。</p></div>
                <h3>合法使用原則</h3>
                <ul aria-label="合法使用原則">
                    <li>僅分析自己擁有或已獲書面授權的資料</li>
                    <li>資料最小化與加密保存，避免任意散布</li>
                    <li>在測試報告中移除可識別內容</li>
                    <li>遵守當地資安與個資法規</li>
                </ul>
                <h3>道德準則</h3>
                <ol aria-label="道德黑客準則">
                    <li>事前告知、事後負責任揭露</li>
                    <li>不造成中斷與資料外洩</li>
                    <li>尊重隱私與合約義務</li>
                    <li>保存證據鏈與操作紀錄</li>
                </ol>
                <div class="warning"><p>本教學僅供教育用途。在任何實務操作前，務必再次確認授權範圍與資料保護要求。</p></div>
                <div class="quiz">
                    <h4>小測驗</h4>
                    <p>在進行雜湊辨識前，最重要的是？</p>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">準備字典</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, true)">取得資料擁有者的書面授權</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">先跑 hashcat</div>
                    <div class="quiz-option" tabindex="0" role="button" onclick="checkAnswer(this, false)">調整 GPU 頻率</div>
                    <p id="quiz-feedback3" style="display:none; margin-top:10px; color:var(--accent);"></p>
                    <div class="explanation"><p><strong>解析：</strong> 書面授權是合法性的基礎，缺乏授權即不可操作。</p></div>
                </div>
            </section>
            <div class="virtual-lab">
                <div class="security-warning"><p>⚠️ 注意：此虛擬實驗室僅供示範。請僅使用測試用雜湊並於授權範圍內練習。</p></div>
                <h3>Hash-Identifier 虛擬實驗室</h3>
                <div class="lab-instructions">
                    <p>按照步驟完成實驗：</p>
                    <ol>
                        <li>啟動工具 <button class="btn-copy" data-cmd="hash-identifier">複製命令</button></li>
                        <li>貼上 MD5 測試值 <button class="btn-copy" data-cmd="5f4dcc3b5aa765d61d8327deb882cf99">複製雜湊</button></li>
                        <li>貼上 SHA-256 測試值 <button class="btn-copy" data-cmd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f">複製雜湊</button></li>
                        <li>貼上 bcrypt 測試值 <button class="btn-copy" data-cmd="$2y$10$abcdefghijklmnopqrstuuS9mC0Z3J7Qf2Gv1yBq8m0C3Cw3x7w">複製雜湊</button></li>
                    </ol>
                </div>
                <div class="terminal" id="virtual-terminal">
                    <div class="terminal-header">
                        <span class="terminal-title">Hash-Identifier Terminal</span>
                        <span class="terminal-controls">○ □ ×</span>
                    </div>
                    <div class="terminal-body" id="terminal-output">
                        <div class="welcome-message">
                            <p>歡迎使用 Hash-Identifier 虛擬終端</p>
                            <p>輸入 "help" 查看可用命令</p>
                            <p>嘗試輸入：<code>identify 5f4dcc3b5aa765d61d8327deb882cf99</code></p>
                        </div>
                    </div>
                    <div class="terminal-input-line">
                        <span class="prompt">hash-id &gt; </span>
                        <input type="text" class="terminal-input" id="terminal-input" aria-label="終端輸入">
                    </div>
                </div>
            </div>
        </main>
        <footer>
            <p>© 2025 資安教學平台 | 僅供教育用途</p>
            <p>使用本教學內容前請確保您了解並遵守相關法律法規</p>
        </footer>
    </div>
    <script>
        window.onload = function() {
            document.querySelector('.skip-link').addEventListener('blur', function() { this.style.top = '-40px'; });
            initVirtualTerminal();
            setupCopyButtons();
            if (localStorage.getItem('hashIdProgress')) {
                document.getElementById('learning-progress').style.width = localStorage.getItem('hashIdProgress');
                updateProgress();
            }
            if (localStorage.getItem('hashIdCompletedQuizzes')) {
                const completedQuizzes = JSON.parse(localStorage.getItem('hashIdCompletedQuizzes'));
                document.querySelectorAll('.quiz-option').forEach(opt => {
                    if (completedQuizzes.includes(opt.textContent.trim())) {
                        opt.style.backgroundColor = 'rgba(76, 175, 80, 0.3)';
                        opt.style.borderLeft = '4px solid var(--success)';
                    }
                });
            }
        };
        function initVirtualTerminal() {
            const terminalInput = document.getElementById('terminal-input');
            const terminalOutput = document.getElementById('terminal-output');
            terminalInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    const command = this.value.trim();
                    if (command) {
                        const commandLine = document.createElement('div');
                        commandLine.className = 'command-line';
                        commandLine.innerHTML = `<span class="prompt">hash-id &gt; </span>${command}`;
                        terminalOutput.appendChild(commandLine);
                        let output = processCommand(command);
                        const outputDiv = document.createElement('div');
                        outputDiv.className = 'command-output';
                        outputDiv.innerHTML = output;
                        terminalOutput.appendChild(outputDiv);
                        terminalOutput.scrollTop = terminalOutput.scrollHeight;
                        this.value = '';
                    }
                }
            });
        }
        function processCommand(command) {
            const lowerCmd = command.toLowerCase();
            if (lowerCmd === 'help') {
                return `可用命令:\nhelp - 顯示此幫助\nidentify <hash> - 嘗試辨識雜湊\nexamples - 顯示範例\nclear - 清除終端`;
            } else if (lowerCmd === 'clear') {
                document.getElementById('terminal-output').innerHTML = '';
                return '';
            } else if (lowerCmd === 'examples') {
                return `範例:\nidentify 5f4dcc3b5aa765d61d8327deb882cf99\nidentify ef92b7...73e94f\nidentify $2y$10$abcdefghijklmnopqrstuuS9mC0Z3J7Qf2Gv1yBq8m0C3Cw3x7w`;
            } else if (lowerCmd.startsWith('identify ')) {
                const hash = command.slice(9).trim();
                return identifyHash(hash);
            } else {
                return `命令 "${command}" 未找到，輸入 "help" 查看可用命令`;
            }
        }
        function identifyHash(hash) {
            const h = hash.trim();
            const hex = /^[0-9a-f]+$/i;
            if (/^\$2[aby]\$\d{2}\$/.test(h)) {
                return `[*] 可能的雜湊：bcrypt (cost=${h.match(/^\$2[aby]\$(\d{2})\$/)?.[1]||'??'})\n[建議] hashcat 模式 -m 3200`;
            }
            if (/^\$argon2(id|i|d)\$/.test(h)) {
                const type = h.match(/^\$(argon2(?:id|i|d))\$/)[1];
                return `[*] 可能的雜湊：${type}\n[提示] 驗證需提供參數/鹽，對應 cracker 模組支援`;
            }
            if (hex.test(h)) {
                if (h.length === 32) return `[*] 可能的雜湊：MD5 / MD4 / NTLM\n[情境] 來源若為 Windows，優先嘗試 NTLM`;
                if (h.length === 40) return `[*] 可能的雜湊：SHA-1`;
                if (h.length === 56) return `[*] 可能的雜湊：SHA-224`;
                if (h.length === 64) return `[*] 可能的雜湊：SHA-256`;
                if (h.length === 96) return `[*] 可能的雜湊：SHA-384`;
                if (h.length === 128) return `[*] 可能的雜湊：SHA-512`;
            }
            if (/^[A-F0-9]{32}$/.test(h)) {
                return `[*] 可能的雜湊：LM / NTLM / MD5（需脈絡）`;
            }
            return `未能判定，請檢查是否為 Base64 或含前綴格式，或改用多工具交叉驗證`;
        }
        function setupCopyButtons() {
            document.querySelectorAll('.command').forEach(cmd => {
                cmd.addEventListener('click', function() { const t = this.textContent.trim(); copyToClipboard(t); showTooltip(this, '已複製到剪貼簿!'); });
                cmd.addEventListener('keydown', function(e) { if (e.key === 'Enter' || e.key === ' ') { const t = this.textContent.trim(); copyToClipboard(t); showTooltip(this, '已複製到剪貼簿!'); } });
            });
            document.querySelectorAll('.btn-copy').forEach(btn => {
                btn.addEventListener('click', function() { const command = this.getAttribute('data-cmd'); copyToClipboard(command); showTooltip(this, '已複製!'); });
            });
        }
        function copyToClipboard(text) { const textarea = document.createElement('textarea'); textarea.value = text; document.body.appendChild(textarea); textarea.select(); document.execCommand('copy'); document.body.removeChild(textarea); }
        function showTooltip(element, message) {
            const tooltip = document.createElement('div');
            tooltip.className = 'custom-tooltip';
            tooltip.textContent = message;
            tooltip.style.position = 'absolute';
            tooltip.style.backgroundColor = 'rgba(0,0,0,0.9)';
            tooltip.style.color = 'white';
            tooltip.style.padding = '5px 10px';
            tooltip.style.borderRadius = '4px';
            tooltip.style.zIndex = '1000';
            tooltip.style.fontSize = '0.9rem';
            const rect = element.getBoundingClientRect();
            tooltip.style.left = `${rect.left}px`;
            tooltip.style.top = `${rect.top - 35}px`;
            document.body.appendChild(tooltip);
            setTimeout(() => { tooltip.style.opacity = '0'; tooltip.style.transition = 'opacity 0.5s'; setTimeout(() => tooltip.remove(), 500); }, 1500);
        }
        function openTab(evt, tabName) {
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) tabContents[i].classList.remove('active');
            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) tabs[i].classList.remove('active');
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
            updateProgress();
        }
        function checkAnswer(selectedOption, isCorrect) {
            const feedbackId = selectedOption.parentElement.querySelector('p[id^="quiz-feedback"]').id;
            const feedbackElement = document.getElementById(feedbackId);
            const explanation = selectedOption.parentElement.nextElementSibling;
            selectedOption.parentElement.querySelectorAll('.quiz-option').forEach(opt => { opt.style.backgroundColor = ''; opt.style.borderLeft = ''; });
            if (isCorrect) {
                selectedOption.style.backgroundColor = 'rgba(76, 175, 80, 0.3)';
                selectedOption.style.borderLeft = '4px solid var(--success)';
                feedbackElement.textContent = '✓ 正確!';
                if (explanation && explanation.classList.contains('explanation')) explanation.style.display = 'block';
            } else {
                selectedOption.style.backgroundColor = 'rgba(244, 67, 54, 0.3)';
                selectedOption.style.borderLeft = '4px solid var(--danger)';
                feedbackElement.textContent = '✗ 不正確，請再試一次。';
            }
            feedbackElement.style.display = 'block';
            if (isCorrect) updateProgress();
        }
        function saveProgress() {
            const progress = document.getElementById('learning-progress').style.width;
            localStorage.setItem('hashIdProgress', progress);
            const completedQuizzes = [];
            document.querySelectorAll('.quiz-option[style*="background-color: rgba(76, 175, 80, 0.3)"]').forEach(opt => { completedQuizzes.push(opt.textContent.trim()); });
            localStorage.setItem('hashIdCompletedQuizzes', JSON.stringify(completedQuizzes));
            const saveButton = document.querySelector('.save-progress');
            const originalText = saveButton.textContent;
            saveButton.textContent = '✓ 進度已保存';
            saveButton.style.backgroundColor = '#3d8b40';
            setTimeout(() => { saveButton.textContent = originalText; saveButton.style.backgroundColor = ''; }, 2000);
        }
        function updateProgress() {
            const completedQuizzes = document.querySelectorAll('.quiz-option[style*="background-color: rgba(76, 175, 80, 0.3)"]').length;
            const progress = Math.min(100, 20 + (completedQuizzes * 15));
            document.getElementById('learning-progress').style.width = `${progress}%`;
            const progressSteps = document.querySelectorAll('.progress-steps li');
            if (progress >= 30) { progressSteps[2].classList.add('active'); progressSteps[1].classList.remove('active'); progressSteps[1].classList.add('completed'); }
            if (progress >= 45) { progressSteps[3].classList.add('active'); progressSteps[2].classList.remove('active'); progressSteps[2].classList.add('completed'); }
            if (progress >= 60) { progressSteps[4].classList.add('active'); progressSteps[3].classList.remove('active'); progressSteps[3].classList.add('completed'); }
            if (progress >= 75) { progressSteps[5].classList.add('active'); progressSteps[4].classList.remove('active'); progressSteps[4].classList.add('completed'); }
        }
        document.querySelector('.save-progress').addEventListener('click', saveProgress);
    </script>
</body>
</html>
